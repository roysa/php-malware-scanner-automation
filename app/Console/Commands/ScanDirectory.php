<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;

class ScanDirectory extends Command
{

    protected $signature = 'scan:directory {directory}';

    public function handle(): int
    {

        $directory = $this->argument('directory');

        $scanner = new \MalwareScanner(false);

        $scanner->setFlagDisableStats(false);
        $scanner->setFlagComments(true);
        $scanner->setFlagBase64(true);
        $scanner->setFlagHideOk(true);
        $scanner->setFlagHideWhitelist(true);
        $scanner->setFlagFollowSymlink(true);

        $this->info('Starting scan of ' . $directory);

        $scanner->run($directory);

        $this->info('Done');

        return 0;
    }

}
